# 0711 Control Plane Environment Configuration

# Application
APP_NAME="0711 Control Plane"
APP_VERSION="0.1.0"
DEBUG=false

# API
API_HOST=0.0.0.0
API_PORT=8080
API_PREFIX=/api

# Database (PostgreSQL)
DATABASE_URL=postgresql://0711:changeme@localhost:5432/0711_control
DB_POOL_SIZE=5
DB_MAX_OVERFLOW=10

# Redis
REDIS_URL=redis://localhost:6379

# Security & JWT
JWT_SECRET=your-super-secret-jwt-key-change-this-in-production
JWT_ALGORITHM=HS256
JWT_EXPIRATION_MINUTES=10080  # 7 days

# Stripe
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PUBLIC_KEY=pk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...

# Email (SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM_EMAIL=noreply@0711.io
SMTP_FROM_NAME=0711 Intelligence

# Frontend URLs
WEBSITE_URL=http://localhost:3000
ADMIN_URL=http://localhost:3001

# Storage
INVOICE_STORAGE_PATH=/var/0711/invoices

# AI APIs (Get from provider consoles)
# Anthropic Claude API: https://console.anthropic.com/settings/keys
ANTHROPIC_API_KEY=sk-ant-api03-your-key-here

# OpenAI API: https://platform.openai.com/api-keys
OPENAI_API_KEY=sk-proj-your-key-here

# Mistral API: https://console.mistral.ai/api-keys
MISTRAL_API_KEY=your-mistral-api-key-here

# Deployment Configuration
DEPLOYMENT_TYPE=managed  # Options: managed, self_hosted, development

# Persistent Data Paths (for self-hosted deployments)
# For managed deployments, these are handled by Docker volumes
LAKEHOUSE_BASE=/var/lib/0711/lakehouse  # Customer lakehouse data (Delta Lake + LanceDB)
LORA_BASE=/var/lib/0711/loras          # Customer LoRA adapters
UPLOAD_BASE=/var/lib/0711/uploads      # Upload staging area

# CORS Origins (comma-separated)
# For production, set to your actual domains
CORS_ORIGINS=["http://localhost:3000","http://localhost:3001","https://0711.io","https://admin.0711.io"]

# ============================================================================
# INTEGRATION WITH NEXT.JS EXPERT NETWORK
# ============================================================================

# Next.js app URL (for sending webhooks)
NEXTJS_URL=http://localhost:3000
# NEXTJS_URL=https://0711.io  # Production

# Shared webhook secret (must match Next.js WEBHOOK_SECRET)
# Generate: openssl rand -base64 32
WEBHOOK_SECRET=change_this_shared_secret_between_systems

# API key for Next.js â†’ FastAPI authentication
# Generate: openssl rand -base64 32
FASTAPI_API_KEY=change_this_api_key_for_nextjs_calls

# ============================================================================
# VLLM MODEL SERVER
# ============================================================================

# Local development (Docker)
VLLM_URL=http://localhost:8000

# Production GPU server (RunPod, Modal, Lambda Labs)
# VLLM_URL=https://[pod-id]-8000.proxy.runpod.net
# VLLM_URL=https://your-vllm.modal.run

# GPU configuration
GPU_MEMORY_GB=80.0  # Total GPU memory (e.g., A100 80GB)
RESERVED_MEMORY_GB=8.0  # Reserved for KV cache

# ============================================================================
# MINIO / S3 STORAGE
# ============================================================================

# Local MinIO (Docker)
MINIO_URL=http://localhost:9000
MINIO_ACCESS_KEY=0711_admin
MINIO_SECRET_KEY=0711_minio_password

# Production S3 or Cloudflare R2
# S3_ENDPOINT=https://s3.eu-central-1.amazonaws.com
# S3_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
# S3_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
# S3_BUCKET=0711-production
# S3_REGION=eu-central-1

# ============================================================================
# LAKEHOUSE
# ============================================================================

# Delta Lake path
DELTA_LAKE_PATH=/var/0711/lakehouse/delta

# LanceDB path
LANCEDB_PATH=/var/0711/lakehouse/lance

# ============================================================================
# MONITORING & LOGGING
# ============================================================================

# Sentry (error tracking)
SENTRY_DSN=

# Log level
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable webhook notifications to Next.js
ENABLE_WEBHOOKS=true

# Enable automatic model loading
ENABLE_MODEL_AUTO_LOADING=true

# Enable LRU eviction when GPU full
ENABLE_LRU_EVICTION=true

# Enable usage tracking for billing
ENABLE_USAGE_TRACKING=true

# ============================================================================
# BACKGROUND PROCESSING
# ============================================================================

# Enable background task workers
ENABLE_BACKGROUND_TASKS=true

# Number of worker processes
TASK_WORKERS=4

# ============================================================================
# MODEL CONFIGURATION
# ============================================================================

# Hugging Face token for downloading gated models (Mixtral)
HF_TOKEN=hf_your_token_here

# Base model configuration
VLLM_MODEL=mistralai/Mixtral-8x7B-Instruct-v0.1
VLLM_TENSOR_PARALLEL=1
VLLM_MAX_MODEL_LEN=32768
VLLM_GPU_MEMORY_UTILIZATION=0.90

# Embedding model
EMBEDDING_MODEL=intfloat/multilingual-e5-large
EMBEDDING_HOST=0.0.0.0
EMBEDDING_PORT=8001

# Local model storage
MODELS_DIR=/app/models
LORAS_DIR=/app/loras

# Model download source
MODEL_REGISTRY_URL=https://models.0711.io

# ============================================================================
# RATE LIMITING
# ============================================================================

RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_PER_HOUR=2000

# ============================================================================
# DEVELOPMENT ONLY
# ============================================================================

# Auto-reload on code changes
RELOAD=true

# Show SQL queries in logs
SHOW_SQL_QUERIES=false

# Skip authentication (DANGEROUS - dev only)
BYPASS_AUTH=false

